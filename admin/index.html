<!doctype html>
<html lang="uk">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>üõ†Ô∏è Destiny Code Admin</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: #0f172a;
            color: #e2e8f0;
        }

        .card {
            background: #1e293b;
            border: 1px solid #334155;
        }

        .badge-active {
            background: #22c55e;
            color: #0f172a;
        }

        .badge-draft {
            background: #f59e0b;
            color: #0f172a;
        }
    </style>
</head>

<body class="min-h-screen p-8">

    <!-- üîê LOGIN SCREEN -->
    <div id="login-screen" class="fixed inset-0 bg-slate-900 flex items-center justify-center z-50">
        <div class="card rounded-2xl p-8 w-full max-w-sm text-center">
            <h2 class="text-2xl font-bold text-white mb-2">üîê –î–æ—Å—Ç—É–ø –¥–æ –ê–¥–º—ñ–Ω–∫–∏</h2>
            <p class="text-slate-400 text-sm mb-6">–í–≤–µ–¥—ñ—Ç—å –ø–∞—Ä–æ–ª—å –¥–ª—è –≤—Ö–æ–¥—É</p>
            <input type="password" id="password-input" placeholder="–ü–∞—Ä–æ–ª—å"
                class="w-full px-4 py-3 rounded-lg bg-slate-800 border border-slate-600 text-white text-center text-lg tracking-widest mb-4 focus:outline-none focus:border-indigo-500"
                autofocus />
            <button id="login-btn"
                class="w-full px-4 py-3 bg-indigo-600 hover:bg-indigo-500 rounded-lg font-semibold transition">
                –£–≤—ñ–π—Ç–∏
            </button>
            <p id="login-error" class="text-red-400 text-sm mt-3 hidden">–ù–µ–≤—ñ—Ä–Ω–∏–π –ø–∞—Ä–æ–ª—å</p>
        </div>
    </div>

    <!-- üìä ADMIN CONTENT (hidden until login) -->
    <div id="admin-content" class="max-w-5xl mx-auto hidden">
        <header class="mb-8">
            <h1 class="text-3xl font-bold text-white mb-2">üõ†Ô∏è Destiny Code Admin</h1>
            <p class="text-slate-400">–ü–∞–Ω–µ–ª—å –∫–µ—Ä—É–≤–∞–Ω–Ω—è –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤–∏–º–∏ –≤–∞—Ä—ñ–∞–Ω—Ç–∞–º–∏</p>
        </header>

        <div class="grid gap-4" id="variants-grid">

            <!-- FEEDBACK LINK -->
            <div class="card rounded-xl p-5 flex items-center justify-between border-green-500/30 bg-green-900/10">
                <div>
                    <div class="flex items-center gap-3 mb-2">
                        <span class="text-xl font-bold text-green-300">üì¢ Feedback</span>
                        <span class="px-2 py-0.5 rounded-full text-xs font-semibold bg-green-500 text-black">NEW</span>
                    </div>
                    <div class="text-sm text-slate-400">
                        –í—ñ–¥–≥—É–∫–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ (Like/Dislike) —Ç–∞ –ø—Ä–æ–ø–æ–∑–∏—Ü—ñ—ó
                    </div>
                </div>
                <a href="/admin/feedback.html"
                    class="px-4 py-2 bg-green-600 hover:bg-green-500 rounded-lg text-sm font-medium transition text-black font-bold">
                    –í—ñ–¥–∫—Ä–∏—Ç–∏ ‚Üí
                </a>
            </div>

            <!-- BOT LOGS LINK -->
            <div class="card rounded-xl p-5 flex items-center justify-between border-indigo-500/30 bg-indigo-900/10">
                <div>
                    <div class="flex items-center gap-3 mb-2">
                        <span class="text-xl font-bold text-indigo-300">ü§ñ Bot Logs</span>
                        <span
                            class="px-2 py-0.5 rounded-full text-xs font-semibold bg-indigo-500 text-white">–ü–ê–ù–ï–õ–¨</span>
                    </div>
                    <div class="text-sm text-slate-400">
                        –ü–µ—Ä–µ–≥–ª—è–¥ –¥—ñ–∞–ª–æ–≥—ñ–≤, —Å–∫–∞—Ä–≥ —Ç–∞ —ñ–¥–µ–π –≤—ñ–¥ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
                    </div>
                </div>
                <a href="/admin/bot-logs.html"
                    class="px-4 py-2 bg-indigo-600 hover:bg-indigo-500 rounded-lg text-sm font-medium transition">
                    –í—ñ–¥–∫—Ä–∏—Ç–∏ ‚Üí
                </a>
            </div>

            <!-- Variants will be rendered here by JS -->
        </div>

        <div class="mt-8 p-4 card rounded-lg text-sm text-slate-400">
            <strong class="text-white">üí° –Ø–∫ —Ä–µ–¥–∞–≥—É–≤–∞—Ç–∏:</strong> –í—ñ–¥–∫—Ä–∏–π –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏–π —Ñ–∞–π–ª —É –ø–∞–ø—Ü—ñ <code
                class="bg-slate-700 px-1 rounded">src/variants/</code> —Ç–∞ –∑–º—ñ–Ω–∏ –ø–æ—Ç—Ä—ñ–±–Ω—ñ –ø–æ–ª—è.
        </div>
    </div>

    <script type="module">
        const ADMIN_PASSWORD = '1536';
        const SESSION_KEY = 'dc_admin_auth';

        const loginScreen = document.getElementById('login-screen');
        const adminContent = document.getElementById('admin-content');
        const passwordInput = document.getElementById('password-input');
        const loginBtn = document.getElementById('login-btn');
        const loginError = document.getElementById('login-error');

        // Check if already authenticated
        if (sessionStorage.getItem(SESSION_KEY) === 'true') {
            showAdmin();
        }

        loginBtn.addEventListener('click', attemptLogin);
        passwordInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') attemptLogin();
        });

        function attemptLogin() {
            if (passwordInput.value === ADMIN_PASSWORD) {
                sessionStorage.setItem(SESSION_KEY, 'true');
                showAdmin();
            } else {
                loginError.classList.remove('hidden');
                passwordInput.classList.add('border-red-500');
            }
        }

        function showAdmin() {
            loginScreen.classList.add('hidden');
            adminContent.classList.remove('hidden');
            loadVariants();
        }

        async function loadVariants() {
            const { VARIANTS } = await import('../src/variants/index.js');
            const { DISPLAY_PRICES } = await import('../src/config.js');
            const grid = document.getElementById('variants-grid');

            function getVariantStatus(variant) {
                if (variant.enabled === false) return { label: '–ß–æ—Ä–Ω–æ–≤–∏–∫', class: 'badge-draft' };
                return { label: '–ê–∫—Ç–∏–≤–Ω–∏–π', class: 'badge-active' };
            }

            function getPriceDisplay(variant) {
                if (variant.pricing && variant.pricing.display && variant.pricing.display.FULL_REPORT) {
                    return variant.pricing.display.FULL_REPORT + ' –≥—Ä–Ω';
                }
                return DISPLAY_PRICES.FULL_REPORT + ' –≥—Ä–Ω (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞)';
            }

            function getOverrides(variant) {
                const overrides = [];
                if (variant.ui && Object.keys(variant.ui).some(k => variant.ui[k])) overrides.push('üé® UI');
                if (variant.aiContext && variant.aiContext.additionalPrompt) overrides.push('ü§ñ –®–Ü');
                if (variant.pricing) overrides.push('üí∞ –¶—ñ–Ω–∞');
                if (variant.ui && variant.ui.backgroundColor) overrides.push('üåà –§–æ–Ω');
                return overrides.length > 0 ? overrides.join(', ') : '–ù–µ–º–∞—î (—ñ–¥–µ–Ω—Ç–∏—á–Ω–∏–π –≥–æ–ª–æ–≤–Ω—ñ–π)';
            }

            Object.entries(VARIANTS).forEach(([id, variant]) => {
                const status = getVariantStatus(variant);
                const card = document.createElement('div');
                card.className = 'card rounded-xl p-5 flex items-center justify-between';
                card.innerHTML = `
                    <div>
                        <div class="flex items-center gap-3 mb-2">
                            <span class="text-xl font-bold text-white">/${id}</span>
                            <span class="px-2 py-0.5 rounded-full text-xs font-semibold ${status.class}">${status.label}</span>
                        </div>
                        <div class="text-sm text-slate-400 space-y-1">
                            <div><strong>–¢–∏–ø:</strong> ${variant.type || 'N/A'}</div>
                            <div><strong>–¶—ñ–Ω–∞:</strong> ${getPriceDisplay(variant)}</div>
                            <div><strong>–û–≤–µ—Ä—Ä–∞–π–¥–∏:</strong> ${getOverrides(variant)}</div>
                            <div><strong>–¢—Ä–µ–∫—ñ–Ω–≥:</strong> ${variant.tracking?.campaignName || 'N/A'}</div>
                        </div>
                    </div>
                    <a href="/${id}" target="_blank" class="px-4 py-2 bg-indigo-600 hover:bg-indigo-500 rounded-lg text-sm font-medium transition">
                        –í—ñ–¥–∫—Ä–∏—Ç–∏ ‚Üí
                    </a>
                `;
                grid.appendChild(card);
            });
        }
    </script>
</body>

</html>